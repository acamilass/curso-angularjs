<!DOCTYPE html>
<html ng-app="meuModulo">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Curso AngularJS</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>

<body ng-controller="indexController">
	<header class="container">
		<h2 ng-bind="titulo"></h2>
	</header>
	<main class="container">
		<div class="row">
			<input type="text" ng-model="busca.nome" placeholder="Busca">
		</div>
		<table class="striped">
			<thead>
				<tr>
					<th>Nome</th>
					<th>E-mail</th>
					<th>Nota 1</th>
					<th>Nota 2</th>
					<th>Nota 3</th>
					<th>MÃ©dia</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="aluno in alunos | filter:busca">
					<td>{{ aluno.nome }}</td>
					<td>{{ aluno.email }}</td>
					<td>{{ aluno.nota1 }}</td>
					<td>{{ aluno.nota2 }}</td>
					<td>{{ aluno.nota3 }}</td>
					<td>{{ aluno.media }}</td>
				</tr>
			</tbody>
		</table>
		<div class="row">
			<a class="waves-effect waves-light btn modal-trigger" href="#modal1">Adicionar</a>
		</div>
	</main>

	<!-- Modal Structure -->
	<div id="modal1" class="modal modal-fixed-footer">
		<div class="modal-content">
			<h4>Adicionar aluno</h4>
			<p>Preencha os dados do aluno</p>
			<div class="row">
				<div class="input-field col m6 s12">
					<input type="text" ng-model="aluno.nome" class="validate">
					<label>Nome</label>
				</div>
				<div class="input-field col m6 s12">
					<input type="email" ng-model="aluno.email" class="validate">
					<label>E-mail</label>
				</div>
			</div>
			<div class="row">
				<div class="input-field col m4 s12">
					<input type="number" ng-model="aluno.nota1" class="validate">
					<label>Nota 1</label>
				</div>
				<div class="input-field col m4 s12">
					<input type="number" ng-model="aluno.nota2" class="validate">
					<label>Nota 2</label>
				</div>
				<div class="input-field col m4 s12">
					<input type="number" ng-model="aluno.nota3" class="validate">
					<label>Nota 3</label>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancelar</a>
			<a class="modal-close waves-effect waves-light btn blue" ng-click="addAluno(aluno)">Adicionar</a>
		</div>
	</div>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<script src="lib/angular/angular.min.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var elems = document.querySelectorAll('.modal');
			var instances = M.Modal.init(elems);
		});
	</script>
	<script>
		angular.module('meuModulo', [])
			.controller('indexController', function ($scope) {
				$scope.titulo = 'Sistema com AngularJS';
				$scope.alunos = [
					{ nome: 'Camila', email: 'camila@mail.com', nota1: 65, nota2: 80, nota3: 55 },
					{ nome: 'Cristina', email: 'cristina@mail.com', nota1: 75, nota2: 80, nota3: 55 },
					{ nome: 'Clara', email: 'clara@mail.com', nota1: 65, nota2: 60, nota3: 55 },
					{ nome: 'Carol', email: 'carol@mail.com', nota1: 95, nota2: 30, nota3: 55 }
				];

				var init = function () {
					$scope.alunos.forEach(function (aluno) {
						aluno.media = media(aluno);
					});
				}

				var media = function (aluno) {
					const media = (aluno.nota1 + aluno.nota2 + aluno.nota3) / 3;
					return media.toFixed(1);
				};

				$scope.addAluno = function(aluno) {
					aluno.media = media(aluno);
					$scope.alunos.push(aluno);
					$scope.aluno = { nome: '', email: '', nota1: null, nota2: null, nota3: null, media: null };
				};

				init();
			});
	</script>
</body>

</html>